import{j as e}from"./jsx-runtime.CDeAccHH.js";import{r as a}from"./index.CqbGxsOR.js";import{T as d,H as b,M as F,F as D,S as N,f as E}from"./FlightInfo.DZx85aa5.js";import{a as k,g as _}from"./actions.DpzvKnMA.js";import{g as C}from"./getCookie.CtV4NB4x.js";import{u as O}from"./store.DBeIxl7_.js";import{L as H}from"./LoaderSpinner.t290QIza.js";import"./index.D2MAbzvX.js";import"./index.Cb2GqDXq.js";async function I(s){try{const t=await fetch("https://vuelos-be.onrender.com/email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.text();return r?JSON.parse(r):{}}catch(t){throw console.error("Error adding flight:",t),t}}const q=()=>{const[s,t]=a.useState("first"),[r,o]=a.useState(!1),[c,h]=a.useState({launchtime:new Date,to:"",from:"",master_passenger:""}),[f,p]=a.useState([{airship_name:"",price_cost:0,price_revenue:0}]),[u,m]=a.useState(!1),{updateFlights:g}=O(n=>n),x=async n=>{n.preventDefault(),m(!0);const{launchtime:S,to:j,from:w,master_passenger:y}=c,v=C("username"),i={launchtime:S.toISOString().slice(0,16),to:j,from:w,master_passenger:y,createdby:v},T={to:i.master_passenger,subject:"Flight pre-scheduled!",text:E(i)};try{await k(i),await I(T);const l=await _();g(l),o(!0),setTimeout(()=>{o(!1),window.location.href="/Trips"},2e3)}catch(l){console.error("Error adding flight:",l)}finally{m(!1)}};return e.jsxs("div",{className:"relative overflow-x-auto overflow-y-auto max-h-[800px] bg-gray-700 w-full max-w-[100%] shadow-md sm:rounded-lg px-6",children:[r&&e.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2",children:e.jsxs(d,{children:[e.jsx("div",{className:"inline-flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-green-100 text-green-500",children:e.jsx(b,{className:"h-5 w-5"})}),e.jsx("div",{className:"ml-3 text-sm font-normal",children:"Flight added successfully."}),e.jsx(d.Toggle,{onClick:()=>o(!1)})]})}),e.jsx(F,{phase:s}),e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("form",{onSubmit:x,children:[e.jsx(D,{phase:s,formData:c,setFormData:h,airshipData:f,setAirshipData:p}),e.jsx(N,{phase:s,setPhase:t,operation:"add"})]})}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsx(H,{})})]})};export{q as default};
