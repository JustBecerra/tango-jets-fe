import{R as I}from"./index.CqbGxsOR.js";const $=e=>{let t;const r=new Set,s=(i,m)=>{const g=typeof i=="function"?i(t):i;if(!Object.is(g,t)){const p=t;t=m??(typeof g!="object"||g===null)?g:Object.assign({},t,g),r.forEach(d=>d(t,p))}},a=()=>t,l={setState:s,getState:a,getInitialState:()=>h,subscribe:i=>(r.add(i),()=>r.delete(i))},h=t=e(s,a,l);return l},O=e=>e?$(e):$,P=e=>e;function j(e,t=P){const r=I.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return I.useDebugValue(r),r}const T=e=>{const t=O(e),r=s=>j(t,s);return Object.assign(r,t),r},F=e=>e?T(e):T;function E(e,t){let r;try{r=e()}catch{return}return{getItem:a=>{var o;const f=h=>h===null?null:JSON.parse(h,void 0),l=(o=r.getItem(a))!=null?o:null;return l instanceof Promise?l.then(f):f(l)},setItem:(a,o)=>r.setItem(a,JSON.stringify(o,void 0)),removeItem:a=>r.removeItem(a)}}const w=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(s){return w(s)(r)},catch(s){return this}}}catch(r){return{then(s){return this},catch(s){return w(s)(r)}}}},k=(e,t)=>(r,s,a)=>{let o={storage:E(()=>localStorage),partialize:n=>n,version:0,merge:(n,S)=>({...S,...n}),...t},f=!1;const l=new Set,h=new Set;let i=o.storage;if(!i)return e((...n)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...n)},s,a);const m=()=>{const n=o.partialize({...s()});return i.setItem(o.name,{state:n,version:o.version})},g=a.setState;a.setState=(n,S)=>{g(n,S),m()};const p=e((...n)=>{r(...n),m()},s,a);a.getInitialState=()=>p;let d;const b=()=>{var n,S;if(!i)return;f=!1,l.forEach(c=>{var u;return c((u=s())!=null?u:p)});const y=((S=o.onRehydrateStorage)==null?void 0:S.call(o,(n=s())!=null?n:p))||void 0;return w(i.getItem.bind(i))(o.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==o.version){if(o.migrate){const u=o.migrate(c.state,c.version);return u instanceof Promise?u.then(v=>[!0,v]):[!0,u]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var u;const[v,H]=c;if(d=o.merge(H,(u=s())!=null?u:p),r(d,!0),v)return m()}).then(()=>{y?.(d,void 0),d=s(),f=!0,h.forEach(c=>c(d))}).catch(c=>{y?.(void 0,c)})};return a.persist={setOptions:n=>{o={...o,...n},n.storage&&(i=n.storage)},clearStorage:()=>{i?.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>b(),hasHydrated:()=>f,onHydrate:n=>(l.add(n),()=>{l.delete(n)}),onFinishHydration:n=>(h.add(n),()=>{h.delete(n)})},o.skipHydration||b(),d||p},_=k,R=F(_(e=>({flights:[],updateFlights:t=>e({flights:t}),airships:[],updateAirships:t=>e({airships:t}),clients:[],updateClients:t=>e({clients:t})}),{name:"data-storage",storage:E(()=>sessionStorage)}));async function J(){try{const e=await fetch("http://localhost:3001/flights");if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return await e.json()}catch(e){throw console.error("Error fetching flights:",e),e}}async function N({id:e,phase:t}){try{const r=await fetch(`http://localhost:3001/flight/phase/${e}/${t}`,{method:"PUT"});if(!r.ok)throw new Error(`Failed to complete phase: ${r.statusText}`);return r.ok}catch(r){return console.error("error completing phase",r),{error:r}}}async function C(e){try{const t=await fetch(`http://localhost:3001/flight/${e}`);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return await t.json()}catch(t){throw console.error(`Error fetching flight #${e}`,t),t}}async function D(e){try{const t=await fetch("http://localhost:3001/flight",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const r=await t.text();return r?JSON.parse(r):{}}catch(t){throw console.error("Error adding flight:",t),t}}export{D as a,C as b,J as g,N as p,R as u};
